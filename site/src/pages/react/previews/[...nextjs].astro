---
import {
  getNextjsPreviewId,
  getNextjsUrlFromRequest,
} from "#app/lib/nextjs.ts";

export const prerender = false;

const url = Astro.url;

// Check if this is a Next.js preview request and redirect
const nextjsExampleId = getNextjsPreviewId(url.pathname);
if (nextjsExampleId) {
  const nextjsUrl = getNextjsUrlFromRequest(url.href, `/${nextjsExampleId}`);
  return Astro.redirect(nextjsUrl, 307);
}

return Astro.rewrite("/404");
---
