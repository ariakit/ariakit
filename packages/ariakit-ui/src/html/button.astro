---
import type { HTMLAttributes } from "astro/types";
import type { VariantProps } from "clava";
import { splitProps } from "clava";
import { button, buttonIcon, buttonText } from "../styles/button.ts";

interface Props
  extends
    HTMLAttributes<"button">,
    VariantProps<typeof button>,
    VariantProps<typeof buttonText> {}

const props: Props = {
  $square: !!Astro.slots.has("icon"),
  ...Astro.props,
};

const [variantProps, textProps, rest] = splitProps(
  props,
  button.html,
  buttonText.html
);
---

<button {...button.html(variantProps)} {...rest}>
  {
    Astro.slots.has("iconStart") && (
      <span {...buttonIcon.html({ $position: "start" })}>
        <slot name="iconStart" />
      </span>
    )
  }
  <slot name="icon" />
  <span {...buttonText.html(textProps)}>
    <slot />
  </span>
  {
    Astro.slots.has("iconEnd") && (
      <span {...buttonIcon.html({ $position: "end" })}>
        <slot name="iconEnd" />
      </span>
    )
  }
</button>
